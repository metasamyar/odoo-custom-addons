Refer to chat for full code.